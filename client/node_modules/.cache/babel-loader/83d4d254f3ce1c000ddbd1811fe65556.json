{"ast":null,"code":"import _regeneratorRuntime from\"/home/deathsmell/WebstormProjects/iAuthManager/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/deathsmell/WebstormProjects/iAuthManager/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/deathsmell/WebstormProjects/iAuthManager/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useCallback,useContext,useEffect,useState}from\"react\";import{useMessage}from\"./message.hook\";import{useHttp}from\"./http.hook\";import{AuthContext}from\"../context/AuthContext\";import{UserContext}from\"../context/UserContext\";var useManage=function useManage(){var _useHttp=useHttp(),request=_useHttp.request;var message=useMessage();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),change=_useState2[0],setChange=_useState2[1];var _useContext=useContext(AuthContext),token=_useContext.token;var _useContext2=useContext(UserContext),_useContext3=_slicedToArray(_useContext2,2),setUsers=_useContext3[1];var getUsers=useCallback(function(setUsers){return request('api/users','GET',null,{Authorization:\"Bearer \".concat(token)}).then(setUsers).catch(function(){return setUsers([]);});},[request,token]);useEffect(function(){if(token)setUsers(getUsers(setUsers));},[token,change,setUsers,getUsers]);var requestToServer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(action,users){var body;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(users&&token)){_context.next=8;break;}_context.next=3;return request(\"api/\".concat(action),'POST',{users:users},{Authorization:\"Bearer \".concat(token)});case 3:body=_context.sent;if(body){message(body);}setChange(!change);_context.next=9;break;case 8:message(\"Incorrect token\");case 9:case\"end\":return _context.stop();}}},_callee);}));return function requestToServer(_x,_x2){return _ref.apply(this,arguments);};}();var blockUsers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(unblockedUsers){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return requestToServer('block',unblockedUsers);case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function blockUsers(_x3){return _ref2.apply(this,arguments);};}();var unblockUsers=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(blockedUsers){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return requestToServer('unblock',blockedUsers);case 2:return _context3.abrupt(\"return\",_context3.sent);case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function unblockUsers(_x4){return _ref3.apply(this,arguments);};}();var deleteUsers=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(currentUsers){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return requestToServer('delete',currentUsers);case 2:return _context4.abrupt(\"return\",_context4.sent);case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function deleteUsers(_x5){return _ref4.apply(this,arguments);};}();return{blockUsers:blockUsers,unblockUsers:unblockUsers,deleteUsers:deleteUsers,getUsers:getUsers};};export default useManage;","map":{"version":3,"sources":["/home/deathsmell/WebstormProjects/iAuthManager/client/src/hooks/manage.hook.js"],"names":["useCallback","useContext","useEffect","useState","useMessage","useHttp","AuthContext","UserContext","useManage","request","message","change","setChange","token","setUsers","getUsers","Authorization","then","catch","requestToServer","action","users","body","blockUsers","unblockedUsers","unblockUsers","blockedUsers","deleteUsers","currentUsers"],"mappings":"qZAAA,OAAQA,WAAR,CAAqBC,UAArB,CAAiCC,SAAjC,CAA4CC,QAA5C,KAA2D,OAA3D,CACA,OAAQC,UAAR,KAAyB,gBAAzB,CACA,OAAQC,OAAR,KAAsB,aAAtB,CACA,OAAQC,WAAR,KAA0B,wBAA1B,CACA,OAAQC,WAAR,KAA0B,wBAA1B,CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,cACFH,OAAO,EADL,CACbI,OADa,UACbA,OADa,CAEpB,GAAMC,CAAAA,OAAO,CAAGN,UAAU,EAA1B,CAFoB,cAGQD,QAAQ,CAAC,KAAD,CAHhB,wCAGbQ,MAHa,eAGLC,SAHK,+BAIJX,UAAU,CAACK,WAAD,CAJN,CAIbO,KAJa,aAIbA,KAJa,kBAKCZ,UAAU,CAACM,WAAD,CALX,6CAKXO,QALW,iBAQpB,GAAMC,CAAAA,QAAQ,CAAGf,WAAW,CAAC,SAACc,QAAD,QAAcL,CAAAA,OAAO,CAAC,WAAD,CAAc,KAAd,CAAqB,IAArB,CAA2B,CAACO,aAAa,kBAAYH,KAAZ,CAAd,CAA3B,CAAP,CACtCI,IADsC,CACjCH,QADiC,EAEtCI,KAFsC,CAEhC,iBAAMJ,CAAAA,QAAQ,CAAC,EAAD,CAAd,EAFgC,CAAd,EAAD,CAEG,CAACL,OAAD,CAASI,KAAT,CAFH,CAA5B,CAKAX,SAAS,CAAC,UAAM,CACZ,GAAIW,KAAJ,CAAWC,QAAQ,CAACC,QAAQ,CAACD,QAAD,CAAT,CAAR,CACd,CAFQ,CAEN,CAACD,KAAD,CAAQF,MAAR,CAAgBG,QAAhB,CAAyBC,QAAzB,CAFM,CAAT,CAKA,GAAMI,CAAAA,eAAe,0FAAG,iBAAOC,MAAP,CAAeC,KAAf,gIAChBA,KAAK,EAAIR,KADO,gDAEGJ,CAAAA,OAAO,eAAQW,MAAR,EAAkB,MAAlB,CAA0B,CAACC,KAAK,CAALA,KAAD,CAA1B,CACtB,CAACL,aAAa,kBAAYH,KAAZ,CAAd,CADsB,CAFV,QAEVS,IAFU,eAIhB,GAAIA,IAAJ,CAAU,CACNZ,OAAO,CAACY,IAAD,CAAP,CACH,CACDV,SAAS,CAAC,CAACD,MAAF,CAAT,CAPgB,6BAShBD,OAAO,mBAAP,CATgB,sDAAH,kBAAfS,CAAAA,eAAe,gDAArB,CAgBA,GAAMI,CAAAA,UAAU,2FAAG,kBAAOC,cAAP,6IACFL,CAAAA,eAAe,CAAC,OAAD,CAAUK,cAAV,CADb,iHAAH,kBAAVD,CAAAA,UAAU,8CAAhB,CAIA,GAAME,CAAAA,YAAY,2FAAG,kBAAOC,YAAP,6IACJP,CAAAA,eAAe,CAAC,SAAD,CAAYO,YAAZ,CADX,iHAAH,kBAAZD,CAAAA,YAAY,8CAAlB,CAIA,GAAME,CAAAA,WAAW,2FAAG,kBAAOC,YAAP,6IACHT,CAAAA,eAAe,CAAC,QAAD,CAAWS,YAAX,CADZ,iHAAH,kBAAXD,CAAAA,WAAW,8CAAjB,CAKA,MAAO,CAACJ,UAAU,CAAVA,UAAD,CAAaE,YAAY,CAAZA,YAAb,CAA2BE,WAAW,CAAXA,WAA3B,CAAwCZ,QAAQ,CAARA,QAAxC,CAAP,CAEH,CAjDD,CAmDA,cAAeP,CAAAA,SAAf","sourcesContent":["import {useCallback, useContext, useEffect, useState} from \"react\";\nimport {useMessage} from \"./message.hook\";\nimport {useHttp} from \"./http.hook\";\nimport {AuthContext} from \"../context/AuthContext\";\nimport {UserContext} from \"../context/UserContext\";\n\nconst useManage = () => {\n    const {request} = useHttp()\n    const message = useMessage();\n    const [change, setChange] = useState(false);\n    const {token} = useContext(AuthContext);\n    const [, setUsers] = useContext(UserContext);\n\n\n    const getUsers = useCallback((setUsers) => request('api/users', 'GET', null, {Authorization: `Bearer ${token}`})\n        .then(setUsers)\n        .catch(() => setUsers([])),[request,token])\n\n\n    useEffect(() => {\n        if (token) setUsers(getUsers(setUsers))\n    }, [token, change, setUsers,getUsers])\n\n\n    const requestToServer = async (action, users) => {\n        if (users && token) {\n            const body = await request(`api/${action}`, 'POST', {users},\n                {Authorization: `Bearer ${token}`})\n            if (body) {\n                message(body)\n            }\n            setChange(!change)\n        } else {\n            message(`Incorrect token`)\n        }\n    }\n\n\n\n\n    const blockUsers = async (unblockedUsers) => {\n        return await requestToServer('block', unblockedUsers)\n    }\n\n    const unblockUsers = async (blockedUsers) => {\n        return await requestToServer('unblock', blockedUsers)\n    }\n\n    const deleteUsers = async (currentUsers) => {\n        return await requestToServer('delete', currentUsers)\n    }\n\n\n    return {blockUsers, unblockUsers, deleteUsers, getUsers,}\n\n}\n\nexport default useManage"]},"metadata":{},"sourceType":"module"}